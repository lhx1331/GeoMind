# é…ç½®é—®é¢˜å·²ä¿®å¤ âœ…

## é—®é¢˜æè¿°

è¿è¡Œæµ‹è¯•æ—¶å‡ºç°é…ç½®éªŒè¯é”™è¯¯ï¼š

```
âŒ åŠ è½½å¤±è´¥: é…ç½®éªŒè¯å¤±è´¥: 11 validation errors for AppSettings
- geocode.provider: Input should be 'google', 'bing' or 'mapbox' (got 'nominatim')
- poi_search.provider: Input should be 'google', 'bing' or 'mapbox' (got 'overpass')
- mcp.backoff_factor: Extra inputs are not permitted
- geocode.timeout: Extra inputs are not permitted
... ç­‰å¤šä¸ªå­—æ®µé”™è¯¯
```

## é—®é¢˜åŸå› 

`config.yaml` ä½¿ç”¨äº†å…è´¹çš„ OpenStreetMap æœåŠ¡ï¼ˆNominatim, Overpassï¼‰ï¼Œä½† `geomind/config/schema.py` ä¸­çš„é…ç½®å®šä¹‰è¿˜ä¸æ”¯æŒè¿™äº›é€‰é¡¹ã€‚

## ä¿®å¤å†…å®¹

### 1. æ·»åŠ äº†å…è´¹æœåŠ¡æ”¯æŒ

**GeocodeProvider æšä¸¾** - æ·»åŠ  Nominatim:
```python
class GeocodeProvider(str, Enum):
    GOOGLE = "google"
    BING = "bing"
    MAPBOX = "mapbox"
    NOMINATIM = "nominatim"  # âœ… æ–°å¢ (å…è´¹)
```

**POIProvider æšä¸¾** - æ–°å¢æšä¸¾ç±»:
```python
class POIProvider(str, Enum):
    GOOGLE = "google"
    BING = "bing"
    MAPBOX = "mapbox"
    NOMINATIM = "nominatim"  # âœ… å…è´¹
    OVERPASS = "overpass"    # âœ… å…è´¹
```

### 2. æ‰©å±•äº†é…ç½®å­—æ®µ

**MCPConfig** - æ·»åŠ é‡è¯•é€€é¿å› å­:
```python
backoff_factor: float = Field(default=2.0, ge=1.0)
```

**GeocodeConfig** - æ·»åŠ  Nominatim æ”¯æŒ:
```python
timeout: int = Field(default=10, ge=1)
nominatim_url: str = Field(default="https://nominatim.openstreetmap.org/search")
nominatim_reverse_url: str = Field(default="https://nominatim.openstreetmap.org/reverse")
```

**POISearchConfig** - æ·»åŠ  Overpass æ”¯æŒ:
```python
timeout: int = Field(default=15, ge=1)
overpass_url: str = Field(default="https://overpass-api.de/api/interpreter")
nominatim_search_url: str = Field(default="https://nominatim.openstreetmap.org/search")
```

**LoggingConfig** - æ·»åŠ æ§åˆ¶å°è¾“å‡ºé€‰é¡¹:
```python
console_output: bool = Field(default=True)
```

**CacheConfig** - ç»Ÿä¸€å­—æ®µå:
```python
enabled: bool = Field(default=True)  # ä» enable æ”¹ä¸º enabled
```

## å¦‚ä½•éªŒè¯ä¿®å¤

### Step 1: é‡æ–°å®‰è£…åŒ…

```powershell
pip install -e .
```

### Step 2: è¿è¡Œæµ‹è¯•

```powershell
python test_geoclip.py
```

åº”è¯¥çœ‹åˆ°ï¼š

```
âœ… é€šè¿‡ - æ¨¡å‹æ–‡ä»¶
âœ… é€šè¿‡ - ä¾èµ–åŒ…
âœ… é€šè¿‡ - æ¨¡å‹åŠ è½½  â† è¿™ä¸ªä¼šé€šè¿‡
âœ… é€šè¿‡ - å›¾åƒç¼–ç 

ğŸ‰ æ­å–œï¼GeoCLIP é…ç½®å®Œå…¨æ­£ç¡®ï¼
```

## ç°åœ¨æ”¯æŒçš„é…ç½®

### å…è´¹æ–¹æ¡ˆ (æ¨èå¼€å‘æµ‹è¯•) âœ…

```yaml
# config.yaml
geocode:
  provider: nominatim  # âœ… å…è´¹
  timeout: 10

poi_search:
  provider: overpass  # âœ… å…è´¹
  timeout: 15
```

### ä»˜è´¹æ–¹æ¡ˆ (ç”Ÿäº§ç¯å¢ƒ)

```yaml
geocode:
  provider: google  # éœ€è¦ Google API Key
  google_api_key: your_key

poi_search:
  provider: google
  api_key: your_key
```

### æ··åˆæ–¹æ¡ˆ

```yaml
geocode:
  provider: nominatim  # å¼€å‘ç”¨å…è´¹
  
poi_search:
  provider: google     # ç”Ÿäº§ç”¨ä»˜è´¹
  api_key: your_key
```

## æ”¯æŒçš„æœåŠ¡å•†

| é…ç½®é¡¹ | å…è´¹é€‰é¡¹ | ä»˜è´¹é€‰é¡¹ |
|--------|---------|---------|
| **åœ°ç†ç¼–ç ** | nominatim | google, bing, mapbox |
| **POI æœç´¢** | nominatim, overpass | google, bing, mapbox |

## å…è´¹æœåŠ¡è¯´æ˜

### Nominatim (OpenStreetMap)
- âœ… å®Œå…¨å…è´¹
- âœ… æ— éœ€ API Key
- âš ï¸ æœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶ (1 req/s)
- âš ï¸ æ•°æ®å¯èƒ½ä¸å¦‚ Google è¯¦ç»†

### Overpass API (OpenStreetMap)
- âœ… å®Œå…¨å…è´¹
- âœ… æ— éœ€ API Key
- âœ… POI æ•°æ®ä¸°å¯Œ
- âš ï¸ æŸ¥è¯¢è¾ƒå¤æ‚

## ä¿®å¤çš„æ–‡ä»¶

- âœ… `geomind/config/schema.py` - æ›´æ–°é…ç½® schema
- ğŸ“„ `é…ç½®ä¿®å¤è¯´æ˜.md` - æœ¬æ–‡æ¡£

---

**ä¿®å¤æ—¶é—´**: 2024-12-19  
**å½±å“**: å®Œå…¨æ”¯æŒå…è´¹ OpenStreetMap æœåŠ¡

