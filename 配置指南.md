# GeoMind é…ç½®æŒ‡å— - æ‚¨çš„æ–¹æ¡ˆ

## âœ… å·²åˆ›å»ºé…ç½®æ–‡ä»¶

å·²ä¸ºæ‚¨åˆ›å»º `config.yaml` é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ï¼š
- **LLM**: DeepSeek (Â¥10/æœˆ)
- **VLM**: æ™ºè°± GLM-4V (Â¥40-80/æœˆ)
- **åœ°å›¾æœåŠ¡**: å…è´¹ OpenStreetMap æ–¹æ¡ˆ

**æ€»æˆæœ¬**: Â¥50-90/æœˆ

---

## ğŸ“‹ æ‚¨éœ€è¦å‡†å¤‡çš„ API Keys æ¸…å•

### âœ… å¿…éœ€çš„ API Keys (2ä¸ª)

#### 1. DeepSeek API Key (LLM - å¿…éœ€)
- **ç”¨é€”**: ç”Ÿæˆåœ°ç†å‡è®¾ã€æ¨ç†åˆ†æ
- **ç”³è¯·åœ°å€**: https://platform.deepseek.com/
- **æˆæœ¬**: Â¥10/æœˆå·¦å³
- **é…ç½®ä½ç½®**: `config.yaml` ç¬¬ 11 è¡Œ

**ç”³è¯·æ­¥éª¤**ï¼š
1. è®¿é—® https://platform.deepseek.com/
2. æ³¨å†Œå¹¶ç™»å½•
3. è¿›å…¥ "API Keys" é¡µé¢
4. ç‚¹å‡» "åˆ›å»ºæ–°çš„ API Key"
5. å¤åˆ¶ Key å¹¶å¡«å…¥ `config.yaml`

#### 2. æ™ºè°± GLM-4V API Key (VLM - å¿…éœ€)
- **ç”¨é€”**: å›¾åƒåˆ†æã€è§†è§‰ç†è§£
- **ç”³è¯·åœ°å€**: https://open.bigmodel.cn/
- **æˆæœ¬**: Â¥40-80/æœˆ
- **é…ç½®ä½ç½®**: `config.yaml` ç¬¬ 22 è¡Œ
- **çŠ¶æ€**: âœ… æ‚¨å·²é‡ç½® API Key

**å¡«å…¥é…ç½®**ï¼š
```yaml
# config.yaml ç¬¬ 22 è¡Œ
glm_api_key: "æ‚¨é‡ç½®åçš„æ–°API_Key"
```

---

### âœ… å¿…éœ€çš„æ¨¡å‹æ–‡ä»¶ (1ä¸ª)

#### 3. GeoCLIP æ¨¡å‹æ–‡ä»¶ (å¿…éœ€)
- **ç”¨é€”**: åœ°ç†ä½ç½®æ£€ç´¢
- **æˆæœ¬**: å…è´¹
- **å¤§å°**: çº¦ 2-3 GB
- **é…ç½®ä½ç½®**: `config.yaml` ç¬¬ 32 è¡Œ

**ä¸‹è½½æ­¥éª¤**ï¼š

**æ–¹å¼ 1: ä½¿ç”¨ Git LFS (æ¨è)**
```bash
# å®‰è£… Git LFS (å¦‚æœæ²¡æœ‰)
git lfs install

# å…‹éš† GeoCLIP æ¨¡å‹
git clone https://huggingface.co/geolocal/StreetCLIP ./models/geoclip
```

**æ–¹å¼ 2: æ‰‹åŠ¨ä¸‹è½½**
1. è®¿é—®: https://huggingface.co/geolocal/StreetCLIP/tree/main
2. ä¸‹è½½æ‰€æœ‰æ–‡ä»¶åˆ° `./models/geoclip/` ç›®å½•
3. ä¸»è¦æ–‡ä»¶ï¼š
   - `pytorch_model.bin` (æœ€å¤§)
   - `config.json`
   - `tokenizer.json`

**ç¡¬ä»¶è¦æ±‚**ï¼š
- **æ¨è**: NVIDIA GPUï¼Œ4GB+ VRAM
- **å¯é€‰**: CPU æ¨¡å¼ï¼ˆä¼šæ…¢ä¸€äº›ï¼‰
  ```yaml
  # å¦‚æœæ²¡æœ‰ GPUï¼Œä¿®æ”¹ config.yaml ç¬¬ 33 è¡Œ
  device: "cpu"
  ```

---

### âŒ ä¸éœ€è¦çš„ API Keys

ä»¥ä¸‹æœåŠ¡æ‚¨**ä¸éœ€è¦**ç”³è¯·ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨å…è´¹æ–¹æ¡ˆï¼š

- âŒ **Google Maps API** - æ”¹ç”¨å…è´¹çš„ Nominatim
- âŒ **OpenAI API** - æ‚¨ç”¨çš„æ˜¯ DeepSeek
- âŒ **Anthropic API** - æ‚¨ç”¨çš„æ˜¯ GLM
- âŒ **E2B API** - ä½¿ç”¨æœ¬åœ°æ²™ç›’
- âŒ **Redis** - ä½¿ç”¨å†…å­˜ç¼“å­˜

---

## ğŸš€ é…ç½®æ­¥éª¤

### Step 1: å¡«å…¥ API Keys

ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼š

```yaml
# ç¬¬ 11 è¡Œ - DeepSeek API Key
deepseek_api_key: "sk-..."  # å¡«å…¥æ‚¨çš„ DeepSeek Key

# ç¬¬ 22 è¡Œ - GLM API Key  
glm_api_key: "..."  # å¡«å…¥æ‚¨é‡ç½®åçš„ GLM Key
```

### Step 2: ä¸‹è½½ GeoCLIP æ¨¡å‹

```bash
# åˆ›å»ºæ¨¡å‹ç›®å½•
mkdir -p models

# ä¸‹è½½ GeoCLIP (é€‰æ‹©æ–¹å¼ 1 æˆ–æ–¹å¼ 2)
git clone https://huggingface.co/geolocal/StreetCLIP ./models/geoclip
```

### Step 3: éªŒè¯é…ç½®

```bash
# è¿è¡Œé…ç½®éªŒè¯è„šæœ¬
python scripts/verify_setup.py
```

---

## ğŸ“¦ å…è´¹åœ°å›¾æœåŠ¡è¯´æ˜

æ‚¨çš„é…ç½®ä½¿ç”¨ä»¥ä¸‹**å…è´¹æœåŠ¡**ï¼ˆæ— éœ€ API Keyï¼‰ï¼š

### 1. Nominatim (åœ°ç†ç¼–ç )
- **æä¾›å•†**: OpenStreetMap
- **åŠŸèƒ½**: åœ°å€ â†” åæ ‡è½¬æ¢
- **é™åˆ¶**: æ¯ç§’ 1 è¯·æ±‚
- **æˆæœ¬**: å®Œå…¨å…è´¹
- **URL**: https://nominatim.openstreetmap.org/

### 2. Overpass API (POI æœç´¢)
- **æä¾›å•†**: OpenStreetMap
- **åŠŸèƒ½**: å…´è¶£ç‚¹æœç´¢
- **é™åˆ¶**: åˆç†ä½¿ç”¨
- **æˆæœ¬**: å®Œå…¨å…è´¹
- **URL**: https://overpass-api.de/

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨å…è´¹
- âœ… æ— éœ€æ³¨å†Œ
- âœ… æ— ä½¿ç”¨é™é¢
- âœ… æ•°æ®å¼€æº

**ç¼ºç‚¹**ï¼š
- âš ï¸ æ•°æ®å¯èƒ½ä¸å¦‚ Google Maps è¯¦ç»†
- âš ï¸ æœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶
- âš ï¸ ä¸­å›½åœ°åŒºæ•°æ®å¯èƒ½ä¸å®Œæ•´

**å¦‚éœ€æ›´å¥½çš„åœ°å›¾æœåŠ¡**ï¼Œå¯ä»¥åç»­å‡çº§åˆ°ï¼š
- é«˜å¾·åœ°å›¾ API (å›½å†…æ¨è)
- Google Maps API (å›½é™…æ¨è)

---

## ğŸ’° æˆæœ¬æ€»è§ˆ

| é¡¹ç›® | æ–¹æ¡ˆ | æœˆæˆæœ¬ |
|------|------|--------|
| **LLM** | DeepSeek | Â¥10 |
| **VLM** | GLM-4V | Â¥40-80 |
| **GeoCLIP** | æœ¬åœ°éƒ¨ç½² | Â¥0 |
| **åœ°å›¾æœåŠ¡** | OpenStreetMap | Â¥0 |
| **æ²™ç›’** | æœ¬åœ° | Â¥0 |
| **æ€»è®¡** | - | **Â¥50-90** |

---

## ğŸ”§ å¯é€‰å‡çº§é¡¹ç›®

å°†æ¥å¦‚éœ€æå‡æ€§èƒ½ï¼Œå¯ä»¥è€ƒè™‘ï¼š

### 1. E2B äº‘æ²™ç›’ (å¯é€‰)
- **ç”¨é€”**: æ›´å®‰å…¨çš„ä»£ç æ‰§è¡Œ
- **æˆæœ¬**: Â¥0-60/æœˆ
- **ç”³è¯·**: https://e2b.dev/

```yaml
# config.yaml
sandbox:
  provider: e2b
  e2b_api_key: "your_e2b_key"
```

### 2. é«˜å¾·åœ°å›¾ API (å¯é€‰ - å›½å†…æ¨è)
- **ç”¨é€”**: æ›´å‡†ç¡®çš„ä¸­å›½åœ°åŒºåœ°ç†æ•°æ®
- **æˆæœ¬**: å…è´¹é¢åº¦å†…é€šå¸¸å¤Ÿç”¨
- **ç”³è¯·**: https://lbs.amap.com/

```yaml
# config.yaml
geocode:
  provider: amap
  amap_api_key: "your_amap_key"
```

### 3. Redis ç¼“å­˜ (å¯é€‰ - åˆ†å¸ƒå¼éƒ¨ç½²)
- **ç”¨é€”**: å…±äº«ç¼“å­˜ï¼Œæå‡æ€§èƒ½
- **æˆæœ¬**: Â¥0-30/æœˆ

```yaml
# config.yaml
cache:
  backend: redis
  redis_host: "localhost"
  redis_port: 6379
```

---

## âœ… é…ç½®æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ­¥éª¤åï¼Œæ‚¨å°±å¯ä»¥å¼€å§‹ä½¿ç”¨ GeoMindï¼š

- [ ] å¡«å…¥ DeepSeek API Key
- [ ] å¡«å…¥ GLM-4V API Key (å·²é‡ç½®)
- [ ] ä¸‹è½½ GeoCLIP æ¨¡å‹æ–‡ä»¶
- [ ] è¿è¡Œé…ç½®éªŒè¯è„šæœ¬
- [ ] æµ‹è¯•å›¾åƒåˆ†æåŠŸèƒ½

---

## ğŸ§ª æµ‹è¯•é…ç½®

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_config.py`ï¼š

```python
import asyncio
from geomind.config import get_settings
from geomind.models.llm import create_llm
from geomind.models.vlm import create_vlm

async def test_configuration():
    """æµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡®"""
    
    print("ğŸ”§ æµ‹è¯•é…ç½®...")
    
    # 1. åŠ è½½é…ç½®
    settings = get_settings()
    print(f"âœ… é…ç½®åŠ è½½æˆåŠŸ")
    print(f"  LLM Provider: {settings.llm.provider}")
    print(f"  VLM Provider: {settings.vlm.provider}")
    
    # 2. æµ‹è¯• DeepSeek LLM
    print("\nğŸ§  æµ‹è¯• DeepSeek LLM...")
    llm = create_llm(provider="deepseek")
    await llm.initialize()
    response = await llm.generate("ä½ å¥½ï¼Œè¯·å›å¤ï¼šé…ç½®æˆåŠŸ")
    print(f"âœ… DeepSeek å“åº”: {response.data[:50]}...")
    await llm.cleanup()
    
    # 3. æµ‹è¯• GLM-4V VLM
    print("\nğŸ‘ï¸ æµ‹è¯• GLM-4V VLM...")
    vlm = create_vlm(provider="glm")
    await vlm.initialize()
    print(f"âœ… GLM-4V åˆå§‹åŒ–æˆåŠŸ")
    await vlm.cleanup()
    
    # 4. æ£€æŸ¥ GeoCLIP æ¨¡å‹
    print("\nğŸ—ºï¸ æ£€æŸ¥ GeoCLIP æ¨¡å‹...")
    from pathlib import Path
    geoclip_path = Path(settings.geoclip.model_path)
    if geoclip_path.exists():
        print(f"âœ… GeoCLIP æ¨¡å‹æ–‡ä»¶å­˜åœ¨: {geoclip_path}")
    else:
        print(f"âš ï¸ GeoCLIP æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨: {geoclip_path}")
        print(f"   è¯·ä¸‹è½½ GeoCLIP æ¨¡å‹åˆ°è¯¥ç›®å½•")
    
    print("\nâœ… æ‰€æœ‰é…ç½®æµ‹è¯•é€šè¿‡ï¼")

if __name__ == "__main__":
    asyncio.run(test_configuration())
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
python test_config.py
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [GLM-4V å¿«é€ŸæŒ‡å—](docs/guides/glm_quickstart.md)
- [DeepSeek é…ç½®æŒ‡å—](docs/guides/deepseek_setup.md)
- [VLM æä¾›å•†å¯¹æ¯”](docs/VLM_COMPARISON.md)
- [å®Œæ•´ API Keys æ¸…å•](docs/API_KEYS_CHECKLIST.md)

---

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç»„åˆï¼Ÿ

**A**: 
- DeepSeek: æ€§ä»·æ¯”æœ€é«˜çš„ LLM (çº¦ GPT-4 çš„ 1/50 ä»·æ ¼)
- GLM-4V: å›½äº§ VLMï¼Œä¸­æ–‡ç†è§£å¥½ï¼Œä»·æ ¼åˆç†
- å…è´¹åœ°å›¾: å¼€å‘æµ‹è¯•é˜¶æ®µæ— éœ€ä»˜è´¹

### Q: é…ç½®æ–‡ä»¶æ”¾åœ¨å“ªé‡Œï¼Ÿ

**A**: `config.yaml` åº”è¯¥æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ŒGeoMind ä¼šè‡ªåŠ¨åŠ è½½ã€‚

### Q: å¯ä»¥åŒæ—¶é…ç½®å¤šä¸ª API Key å—ï¼Ÿ

**A**: å¯ä»¥ï¼é…ç½®æ–‡ä»¶æ”¯æŒé…ç½®å¤šä¸ªæä¾›å•†çš„ Keyï¼Œæ–¹ä¾¿åˆ‡æ¢ï¼š

```yaml
llm:
  provider: deepseek  # å½“å‰ä½¿ç”¨
  deepseek_api_key: "..."
  openai_api_key: "..."  # å¤‡ç”¨
```

### Q: å¦‚ä½•åˆ‡æ¢åˆ°å…¶ä»–æä¾›å•†ï¼Ÿ

**A**: åªéœ€ä¿®æ”¹ `provider` å­—æ®µï¼š

```yaml
vlm:
  provider: openai  # æ”¹ä¸º openai, qwen, ç­‰
```

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé…ç½®è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ—¥å¿—: `tail -f logs/geomind.log`
2. è¿è¡ŒéªŒè¯è„šæœ¬: `python scripts/verify_setup.py`
3. æŸ¥çœ‹æ–‡æ¡£: [é…ç½®ç®¡ç†è¯¦è§£](docs/guides/configuration.md)

---

**åˆ›å»ºæ—¶é—´**: 2024-12-19  
**é€‚ç”¨ç‰ˆæœ¬**: GeoMind v1.0

